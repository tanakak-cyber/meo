# æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

## ğŸ“‹ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³æ§‹æˆ

### â‘  ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³æ§‹æˆ

| é …ç›® | å€¤ | å‚™è€ƒ |
|------|-----|------|
| **Laravelãƒãƒ¼ã‚¸ãƒ§ãƒ³** | `^12.0` | æœ€æ–°ã®Laravel 12ç³» |
| **PHPãƒãƒ¼ã‚¸ãƒ§ãƒ³** | `^8.2` | PHP 8.2ä»¥ä¸Šå¿…é ˆ |
| **Node.jsä½¿ç”¨** | âœ… ã‚ã‚Š | Playwrightã€Viteä½¿ç”¨ |
| **Node.jsãƒãƒ¼ã‚¸ãƒ§ãƒ³** | ç¢ºèªãŒå¿…è¦ | `package.json`ã«è¨˜è¼‰ãªã—ã€v20.14.0ä»¥ä¸Šæ¨å¥¨ |
| **ãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ«** | **Vite** | `webpack.mix.js`ã¯å­˜åœ¨ã—ãªã„ |
| **ãƒ“ãƒ«ãƒ‰å¿…é ˆ** | âœ… **å¿…é ˆ** | `npm run build`å®Ÿè¡ŒãŒå¿…è¦ |

### â‘¡ å¤–éƒ¨æŠ€è¡“ã®ä½¿ç”¨

| æŠ€è¡“ | ä½¿ç”¨ç®‡æ‰€ | æœ¬ç•ªè¦ä»¶ |
|------|---------|---------|
| **Playwright** | âœ… ä½¿ç”¨ä¸­ | `rank-worker.cjs`, `rank-fetch-server.cjs` |
| **Chromeä¾å­˜** | âœ… ã‚ã‚Š | PlaywrightãŒChromiumã‚’ä½¿ç”¨ï¼ˆã¾ãŸã¯Chrome 9222ãƒãƒ¼ãƒˆæ¥ç¶šï¼‰ |
| **Google OAuth** | âœ… ä½¿ç”¨ä¸­ | `GoogleBusinessProfileService` |
| **Google Business Profile API** | âœ… ä½¿ç”¨ä¸­ | å£ã‚³ãƒŸãƒ»å†™çœŸãƒ»æŠ•ç¨¿åŒæœŸ |
| **OpenAI API** | âœ… ä½¿ç”¨ä¸­ | `OpenAIService` |
| **å¤–éƒ¨APIã‚­ãƒ¼** | ä»¥ä¸‹å‚ç…§ | ç’°å¢ƒå¤‰æ•°ã§ç®¡ç† |

#### å¤–éƒ¨APIã‚­ãƒ¼ä¸€è¦§ï¼ˆ`.env`å¿…é ˆé …ç›®ï¼‰

```
# Google OAuth
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=
GOOGLE_REDIRECT_URI=

# OpenAI
OPENAI_API_KEY=

# AWSï¼ˆS3ä½¿ç”¨æ™‚ã®ã¿ï¼‰
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_DEFAULT_REGION=
AWS_BUCKET=
AWS_URL=
AWS_ENDPOINT=

# ãƒ¡ãƒ¼ãƒ«é€ä¿¡ï¼ˆé¸æŠï¼‰
POSTMARK_API_KEY=
RESEND_API_KEY=
AWS_ACCESS_KEY_ID= (SESä½¿ç”¨æ™‚)
AWS_SECRET_ACCESS_KEY= (SESä½¿ç”¨æ™‚)

# Slacké€šçŸ¥ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
SLACK_BOT_USER_OAUTH_TOKEN=
SLACK_BOT_USER_DEFAULT_CHANNEL=
```

### â‘¢ Queue / Schedule

| é …ç›® | çŠ¶æ…‹ | æœ¬ç•ªè¦ä»¶ |
|------|------|---------|
| **Queueä½¿ç”¨** | âœ… ä½¿ç”¨ä¸­ | `SyncShopDataJob`ãªã© |
| **Queueãƒ‰ãƒ©ã‚¤ãƒ** | `database` | `.env`ã§`QUEUE_CONNECTION=database` |
| **Supervisorå¿…è¦** | âœ… **å¿…é ˆ** | `php artisan queue:work`å¸¸é§åŒ– |
| **Scheduleä½¿ç”¨** | âœ… ä½¿ç”¨ä¸­ | `routes/console.php`ã«å®šç¾© |
| **Cronç™»éŒ²** | âœ… **å¿…é ˆ** | ä»¥ä¸‹å‚ç…§ |

#### Cronç™»éŒ²ãŒå¿…è¦ãªã‚³ãƒãƒ³ãƒ‰

```bash
# Laravel Schedulerï¼ˆæ¯åˆ†å®Ÿè¡Œï¼‰
* * * * * cd /path-to-project && php artisan schedule:run >> /dev/null 2>&1
```

#### ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¿ã‚¹ã‚¯ä¸€è¦§

1. **æœˆæ¬¡ãƒ¬ãƒãƒ¼ãƒˆé€ä¿¡**
   - ã‚³ãƒãƒ³ãƒ‰: `reports:send-monthly`
   - å®Ÿè¡Œã‚¿ã‚¤ãƒŸãƒ³ã‚°: æ¯æœˆ7æ—¥ 09:00 (JST)
   - ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³: `Asia/Tokyo`

2. **ãƒ–ãƒ­ã‚°è‡ªå‹•ã‚¯ãƒ­ãƒ¼ãƒ«ãƒ»æŠ•ç¨¿**
   - ã‚³ãƒãƒ³ãƒ‰: `blog:crawl`
   - å®Ÿè¡Œã‚¿ã‚¤ãƒŸãƒ³ã‚°: æ¯åˆ†
   - ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³: `Asia/Tokyo`
   - é‡è¤‡å®Ÿè¡Œé˜²æ­¢: `withoutOverlapping()`

#### Node.jsã‚¹ã‚¯ãƒªãƒ—ãƒˆå®šæœŸå®Ÿè¡Œ

- **`rank-worker.cjs`**: ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰é †ä½å–å¾—ãƒ¯ãƒ¼ã‚«ãƒ¼
  - å®Ÿè¡Œæ–¹æ³•: `node rank-worker.cjs`
  - å¸¸é§åŒ–: **PM2æ¨å¥¨** ã¾ãŸã¯ Supervisor
  - ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹: SQLite/MySQLå¯¾å¿œ
  - ç’°å¢ƒå¤‰æ•°: `.env`ã‹ã‚‰`DB_CONNECTION`, `DB_HOST`, `DB_DATABASE`, `DB_USERNAME`, `DB_PASSWORD`ã‚’èª­ã¿è¾¼ã¿

- **`rank-fetch-server.cjs`**: é †ä½å–å¾—ã‚µãƒ¼ãƒãƒ¼
  - å®Ÿè¡Œæ–¹æ³•: `node rank-fetch-server.cjs`
  - ãƒãƒ¼ãƒˆ: **3000**
  - ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯: `http://localhost:3000/health`
  - Chromeæ¥ç¶š: **9222ãƒãƒ¼ãƒˆã§Chromeèµ·å‹•ãŒå¿…è¦**
  - èµ·å‹•ã‚³ãƒãƒ³ãƒ‰: `chrome --remote-debugging-port=9222` (Linux: `google-chrome` ã¾ãŸã¯ `chromium`)
  - APIæ¥ç¶š: `http://localhost:8000/api/rank-log` ã«POSTãƒªã‚¯ã‚¨ã‚¹ãƒˆé€ä¿¡

### â‘£ ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸

| é …ç›® | å€¤ | æœ¬ç•ªè¦ä»¶ |
|------|-----|---------|
| **ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‡ã‚£ã‚¹ã‚¯** | `local` | `.env`ã§`FILESYSTEM_DISK=local` |
| **S3ä½¿ç”¨** | ã‚ªãƒ—ã‚·ãƒ§ãƒ³ | `.env`ã§è¨­å®šå¯èƒ½ |
| **storage:linkå¿…é ˆ** | âœ… **å¿…é ˆ** | `php artisan storage:link`å®Ÿè¡Œ |
| **å…¬é–‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª** | `storage/app/public` | `public/storage`ã«ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ä½œæˆ |

#### ãƒ¡ãƒ‡ã‚£ã‚¢ä¿å­˜ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª

- `storage/app/public/media-assets/`: æŠ•ç¨¿ç´ æï¼ˆç”»åƒãƒ»å‹•ç”»ï¼‰
- `storage/app/private/`: ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«
- `storage/puppeteer-profile/`: Playwrightãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆé–‹ç™ºç’°å¢ƒã®ã¿ï¼Ÿï¼‰

### â‘¤ ç’°å¢ƒå¤‰æ•°

#### `.env`ã§å¿…é ˆãªé …ç›®ä¸€è¦§

```bash
# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åŸºæœ¬è¨­å®š
APP_NAME=MEO
APP_ENV=production
APP_KEY=base64:...  # php artisan key:generate ã§ç”Ÿæˆ
APP_DEBUG=false  # âš ï¸ æœ¬ç•ªã§ã¯å¿…ãšfalse
APP_URL=https://your-domain.com

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
DB_CONNECTION=mysql  # ã¾ãŸã¯ sqlite
DB_HOST=127.0.0.1
DB_PORT=3306
DB_DATABASE=meo
DB_USERNAME=your_user
DB_PASSWORD=your_password

# Queue
QUEUE_CONNECTION=database

# ãƒ¡ãƒ¼ãƒ«è¨­å®šï¼ˆâš ï¸ æœ¬ç•ªã§ã¯å¿…ãšå¤‰æ›´ï¼‰
MAIL_MAILER=smtp  # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯logï¼ˆæœ¬ç•ªã§ã¯å¤‰æ›´å¿…é ˆï¼‰
MAIL_HOST=
MAIL_PORT=587
MAIL_USERNAME=
MAIL_PASSWORD=
MAIL_ENCRYPTION=tls
MAIL_FROM_ADDRESS=noreply@your-domain.com
MAIL_FROM_NAME="${APP_NAME}"

# Google OAuth
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=
GOOGLE_REDIRECT_URI=https://your-domain.com/shops/google/callback

# OpenAI
OPENAI_API_KEY=

# ãƒ­ã‚°
LOG_CHANNEL=stack  # ã¾ãŸã¯ daily, single
LOG_LEVEL=error  # æœ¬ç•ªã§ã¯errorä»¥ä¸Šæ¨å¥¨

# ã‚»ãƒƒã‚·ãƒ§ãƒ³
SESSION_DRIVER=database  # ã¾ãŸã¯ file, redis
SESSION_LIFETIME=120

# ã‚­ãƒ£ãƒƒã‚·ãƒ¥
CACHE_STORE=database  # ã¾ãŸã¯ file, redis
```

#### æœ¬ç•ªã§å¤‰æ›´å¿…é ˆãªã‚‚ã®

- âœ… `APP_ENV=production`
- âœ… `APP_DEBUG=false` **ï¼ˆæœ€é‡è¦ï¼‰**
- âœ… `APP_URL` â†’ æœ¬ç•ªãƒ‰ãƒ¡ã‚¤ãƒ³
- âœ… `LOG_LEVEL=error` ã¾ãŸã¯ `warning`
- âœ… ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šæƒ…å ±
- âœ… Google OAuthãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆURI
- âœ… ãƒ¡ãƒ¼ãƒ«é€ä¿¡è¨­å®š

### â‘¥ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹

| é …ç›® | å€¤ | å‚™è€ƒ |
|------|-----|------|
| **ä½¿ç”¨DBç¨®åˆ¥** | MySQL / SQLite | `.env`ã§`DB_CONNECTION`è¨­å®š |
| **Migrationæ•°** | **ç´„70ä»¶** | `database/migrations/`é…ä¸‹ |
| **Seedå¿…é ˆ** | âš ï¸ **æ‰‹å‹•ä½œæˆæ¨å¥¨** | `DatabaseSeeder`ã¯ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿ä½œæˆ |
| **åˆæœŸãƒ‡ãƒ¼ã‚¿** | âš ï¸ **æ‰‹å‹•ä½œæˆå¿…è¦** | ç®¡ç†è€…ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€ãƒ—ãƒ©ãƒ³ã€ãƒã‚¹ã‚¿ãƒ‡ãƒ¼ã‚¿ãªã© |

#### ä¸»è¦ãƒ†ãƒ¼ãƒ–ãƒ«

- `users`: ç®¡ç†è€…ãƒ»ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ãƒ¼
- `shops`: åº—èˆ—æƒ…å ±
- `reviews`: å£ã‚³ãƒŸ
- `photos`: å†™çœŸ
- `gbp_posts`: GBPæŠ•ç¨¿
- `gbp_snapshots`: GBPã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ
- `meo_keywords`: MEOã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰
- `meo_rank_logs`: é †ä½ãƒ­ã‚°
- `rank_fetch_jobs`: é †ä½å–å¾—ã‚¸ãƒ§ãƒ–
- `sync_batches`: åŒæœŸãƒãƒƒãƒ
- `jobs`, `job_batches`, `failed_jobs`: Queueé–¢é€£

### â‘¦ ã‚­ãƒ£ãƒƒã‚·ãƒ¥

| ã‚³ãƒãƒ³ãƒ‰ | å¿…é ˆ | å‚™è€ƒ |
|----------|------|------|
| `php artisan config:cache` | âœ… **æ¨å¥¨** | æœ¬ç•ªã§ã¯å¿…é ˆ |
| `php artisan route:cache` | âœ… **æ¨å¥¨** | æœ¬ç•ªã§ã¯å¿…é ˆ |
| `php artisan view:cache` | âœ… **æ¨å¥¨** | æœ¬ç•ªã§ã¯å¿…é ˆ |
| `php artisan event:cache` | âš ï¸ ç¢ºèªãŒå¿…è¦ | ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ä½¿ç”¨æ™‚ |

### â‘§ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒªã‚¹ã‚¯

#### âš ï¸ ç¢ºèªãŒå¿…è¦ãªé …ç›®

1. **APP_DEBUG**
   - âœ… ã‚³ãƒ¼ãƒ‰ç¢ºèª: `config/app.php`ã§`env('APP_DEBUG', false)` â†’ ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆfalse
   - âš ï¸ **æœ¬ç•ª`.env`ã§`APP_DEBUG=false`ã‚’æ˜ç¤ºçš„ã«è¨­å®š**

2. **ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰APIã‚­ãƒ¼**
   - âœ… ã‚³ãƒ¼ãƒ‰ç¢ºèª: ã™ã¹ã¦`env()`ã¾ãŸã¯`config()`çµŒç”±ã§å–å¾—
   - âœ… ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ãªã—

3. **ãƒ­ã‚°ã«æ©Ÿå¯†æƒ…å ±å‡ºåŠ›**
   - âš ï¸ **ç¢ºèªãŒå¿…è¦**: `Log::info()`, `Log::debug()`ã§ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒ»ãƒˆãƒ¼ã‚¯ãƒ³å‡ºåŠ›ã—ã¦ã„ãªã„ã‹
   - æ¨å¥¨: æœ¬ç•ªã§ã¯`LOG_LEVEL=error`ã«è¨­å®š

4. **ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®å…¬é–‹ãƒªã‚¹ã‚¯**
   - âœ… `storage/app/public`ã¯`storage:link`ã§å…¬é–‹
   - âš ï¸ `storage/app/private`ã¯éå…¬é–‹ï¼ˆç¢ºèªï¼‰

5. **.envãƒ•ã‚¡ã‚¤ãƒ«ã®å…¬é–‹**
   - âœ… `.gitignore`ã«`.env`ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
   - âš ï¸ æœ¬ç•ªã‚µãƒ¼ãƒãƒ¼ã§`.env`ãŒWebãƒ«ãƒ¼ãƒˆã«é…ç½®ã•ã‚Œã¦ã„ãªã„ã‹ç¢ºèª

### â‘¨ æœ¬ç•ªæ§‹ç¯‰ã«å¿…è¦ãªã‚µãƒ¼ãƒãƒ¼è¦ä»¶

#### å¿…é ˆè¦ä»¶

| é …ç›® | è¦ä»¶ | å‚™è€ƒ |
|------|------|------|
| **PHP** | 8.2ä»¥ä¸Š | `composer.json`ã§`^8.2`æŒ‡å®š |
| **PHPæ‹¡å¼µ** | ç¢ºèªãŒå¿…è¦ | `ext-mbstring`, `ext-openssl`, `ext-pdo`, `ext-curl`ãªã© |
| **Node.js** | v20.14.0ä»¥ä¸Šæ¨å¥¨ | Playwrightå‹•ä½œç¢ºèªæ¸ˆã¿ |
| **Chrome/Chromium** | å¿…è¦ | PlaywrightãŒä½¿ç”¨ |
| **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹** | MySQL 5.7+ / SQLite 3 | æœ¬ç•ªã¯MySQLæ¨å¥¨ |
| **Webã‚µãƒ¼ãƒãƒ¼** | Nginx / Apache | PHP-FPMå¿…é ˆ |
| **å¿…è¦ãƒãƒ¼ãƒˆ** | 80, 443, 3306(MySQL), 3000(Node.js), 9222(Chrome) | æœ¬ç•ªç’°å¢ƒã§é–‹ãå¿…è¦ã‚ã‚Š |

#### Linuxä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼ˆç¢ºèªãŒå¿…è¦ï¼‰

- `libnss3`, `libatk-bridge2.0-0`, `libdrm2`, `libxkbcommon0`, `libxcomposite1`, `libxdamage1`, `libxrandr2`, `libgbm1`, `libxss1`, `libasound2` (Playwrightç”¨)

---

## ğŸš€ æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤ã«å¿…è¦ãªä½œæ¥­ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### ã‚¹ãƒ†ãƒƒãƒ—1: ã‚µãƒ¼ãƒãƒ¼æº–å‚™

- [ ] PHP 8.2ä»¥ä¸Šã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
- [ ] Composerã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
- [ ] Node.js v20.14.0ä»¥ä¸Šã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
- [ ] MySQLã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒ»è¨­å®š
- [ ] Nginx/Apacheè¨­å®š
- [ ] PHP-FPMè¨­å®š
- [ ] Chrome/Chromiumã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆPlaywrightç”¨ï¼‰
- [ ] Playwrightä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

### ã‚¹ãƒ†ãƒƒãƒ—2: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é…ç½®

- [ ] Gitãƒªãƒã‚¸ãƒˆãƒªã‚¯ãƒ­ãƒ¼ãƒ³
- [ ] `.env`ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
- [ ] `.env`ã«æœ¬ç•ªç’°å¢ƒå¤‰æ•°è¨­å®š
  - [ ] `APP_ENV=production`
  - [ ] `APP_DEBUG=false`
  - [ ] `APP_URL`è¨­å®š
  - [ ] ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šæƒ…å ±
  - [ ] Google OAuthè¨­å®š
  - [ ] OpenAI APIã‚­ãƒ¼
  - [ ] ãƒ¡ãƒ¼ãƒ«è¨­å®š
  - [ ] ãã®ä»–APIã‚­ãƒ¼

### ã‚¹ãƒ†ãƒƒãƒ—3: ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

- [ ] `composer install --no-dev --optimize-autoloader`
- [ ] `npm install`
- [ ] `npm run build` (Viteãƒ“ãƒ«ãƒ‰)

### ã‚¹ãƒ†ãƒƒãƒ—4: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­å®š

- [ ] ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä½œæˆ
- [ ] `php artisan key:generate` (APP_KEYç”Ÿæˆ)
- [ ] `php artisan migrate --force`
- [ ] **åˆæœŸãƒ‡ãƒ¼ã‚¿æ‰‹å‹•ä½œæˆ**ï¼ˆ`DatabaseSeeder`ã¯ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿ï¼‰
  - [ ] ç®¡ç†è€…ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆï¼ˆ`php artisan tinker`ã¾ãŸã¯ç›´æ¥DBæ“ä½œï¼‰
  - [ ] ãƒ—ãƒ©ãƒ³ãƒ‡ãƒ¼ã‚¿ä½œæˆ
  - [ ] å–¶æ¥­æ‹…å½“è€…ãƒ»ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ‹…å½“è€…ãƒ‡ãƒ¼ã‚¿ä½œæˆ
  - [ ] ãã®ä»–ãƒã‚¹ã‚¿ãƒ‡ãƒ¼ã‚¿ä½œæˆ

### ã‚¹ãƒ†ãƒƒãƒ—5: ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸è¨­å®š

- [ ] `php artisan storage:link` (ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ä½œæˆ)
- [ ] `storage/`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ¨©é™è¨­å®šï¼ˆ`chmod -R 775 storage bootstrap/cache`ï¼‰
- [ ] `storage/app/public`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆãƒ»æ¨©é™è¨­å®š

### ã‚¹ãƒ†ãƒƒãƒ—6: ã‚­ãƒ£ãƒƒã‚·ãƒ¥æœ€é©åŒ–

- [ ] `php artisan config:cache`
- [ ] `php artisan route:cache`
- [ ] `php artisan view:cache`
- [ ] `php artisan event:cache` (ã‚¤ãƒ™ãƒ³ãƒˆä½¿ç”¨æ™‚)

### ã‚¹ãƒ†ãƒƒãƒ—7: Queueå¸¸é§åŒ–ï¼ˆSupervisorè¨­å®šï¼‰

#### Supervisorè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ä¾‹: `/etc/supervisor/conf.d/meo-queue.conf`

```ini
[program:meo-queue-worker]
process_name=%(program_name)s_%(process_num)02d
command=php /path-to-project/artisan queue:work database --sleep=3 --tries=3 --max-time=3600
autostart=true
autorestart=true
stopasgroup=true
killasgroup=true
user=www-data
numprocs=2
redirect_stderr=true
stdout_logfile=/path-to-project/storage/logs/queue-worker.log
stopwaitsecs=3600
```

- [ ] Supervisorè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
- [ ] `supervisorctl reread`
- [ ] `supervisorctl update`
- [ ] `supervisorctl start meo-queue-worker:*`

### ã‚¹ãƒ†ãƒƒãƒ—8: Cronç™»éŒ²

#### Crontabè¨­å®š

```bash
# Laravel Schedulerï¼ˆæ¯åˆ†å®Ÿè¡Œï¼‰
* * * * * cd /path-to-project && php artisan schedule:run >> /dev/null 2>&1
```

- [ ] `crontab -e`ã§ä¸Šè¨˜ã‚’è¿½åŠ 
- [ ] ã¾ãŸã¯`/etc/cron.d/meo-scheduler`ã«è¿½åŠ 

### ã‚¹ãƒ†ãƒƒãƒ—9: Chromeèµ·å‹•è¨­å®šï¼ˆé †ä½å–å¾—æ©Ÿèƒ½ä½¿ç”¨æ™‚ï¼‰

- [ ] Chrome/Chromiumã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
- [ ] Chromeèµ·å‹•ã‚¹ã‚¯ãƒªãƒ—ãƒˆä½œæˆï¼ˆSupervisorã¾ãŸã¯systemdï¼‰

#### Supervisorè¨­å®šä¾‹: `/etc/supervisor/conf.d/chrome-debug.conf`

```ini
[program:chrome-debug]
command=/usr/bin/google-chrome --remote-debugging-port=9222 --no-sandbox --disable-dev-shm-usage
autostart=true
autorestart=true
user=www-data
redirect_stderr=true
stdout_logfile=/var/log/chrome-debug.log
```

- [ ] `supervisorctl reread`
- [ ] `supervisorctl update`
- [ ] `supervisorctl start chrome-debug`

### ã‚¹ãƒ†ãƒƒãƒ—10: Node.jsã‚¹ã‚¯ãƒªãƒ—ãƒˆå¸¸é§åŒ–ï¼ˆPM2æ¨å¥¨ï¼‰

#### PM2è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ä¾‹: `ecosystem.config.js`

```javascript
module.exports = {
  apps: [
    {
      name: 'rank-worker',
      script: 'rank-worker.cjs',
      instances: 1,
      autorestart: true,
      watch: false,
      max_memory_restart: '1G',
      env: {
        NODE_ENV: 'production',
        DB_CONNECTION: 'mysql',
        DB_HOST: '127.0.0.1',
        DB_DATABASE: 'meo',
        DB_USERNAME: 'your_user',
        DB_PASSWORD: 'your_password',
      },
    },
    {
      name: 'rank-fetch-server',
      script: 'rank-fetch-server.cjs',
      instances: 1,
      autorestart: true,
      watch: false,
      max_memory_restart: '1G',
      env: {
        NODE_ENV: 'production',
        PORT: 3000,
      },
    },
  ],
};
```

- [ ] PM2ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«: `npm install -g pm2`
- [ ] `ecosystem.config.js`ä½œæˆ
- [ ] `pm2 start ecosystem.config.js`
- [ ] `pm2 save`
- [ ] `pm2 startup` (ã‚·ã‚¹ãƒ†ãƒ èµ·å‹•æ™‚ã«è‡ªå‹•èµ·å‹•)

### ã‚¹ãƒ†ãƒƒãƒ—11: Webã‚µãƒ¼ãƒãƒ¼è¨­å®š

#### Nginxè¨­å®šä¾‹

```nginx
server {
    listen 80;
    server_name your-domain.com;
    root /path-to-project/public;

    add_header X-Frame-Options "SAMEORIGIN";
    add_header X-Content-Type-Options "nosniff";

    index index.php;

    charset utf-8;

    location / {
        try_files $uri $uri/ /index.php?$query_string;
    }

    location = /favicon.ico { access_log off; log_not_found off; }
    location = /robots.txt  { access_log off; log_not_found off; }

    error_page 404 /index.php;

    location ~ \.php$ {
        fastcgi_pass unix:/var/run/php/php8.2-fpm.sock;
        fastcgi_param SCRIPT_FILENAME $realpath_root$fastcgi_script_name;
        include fastcgi_params;
    }

    location ~ /\.(?!well-known).* {
        deny all;
    }
}
```

- [ ] Nginxè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
- [ ] `nginx -t`ã§è¨­å®šç¢ºèª
- [ ] `systemctl reload nginx`

### ã‚¹ãƒ†ãƒƒãƒ—12: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç¢ºèª

- [ ] `.env`ãƒ•ã‚¡ã‚¤ãƒ«ãŒWebãƒ«ãƒ¼ãƒˆã«é…ç½®ã•ã‚Œã¦ã„ãªã„ã‹ç¢ºèª
- [ ] `APP_DEBUG=false`ç¢ºèª
- [ ] `LOG_LEVEL=error`ç¢ºèª
- [ ] ãƒ•ã‚¡ã‚¤ãƒ«æ¨©é™ç¢ºèªï¼ˆ`storage/`, `bootstrap/cache/`ã¯775ï¼‰
- [ ] `.env`ãƒ•ã‚¡ã‚¤ãƒ«æ¨©é™ç¢ºèªï¼ˆ600æ¨å¥¨ï¼‰
- [ ] SSLè¨¼æ˜æ›¸è¨­å®šï¼ˆHTTPSå¿…é ˆï¼‰

### ã‚¹ãƒ†ãƒƒãƒ—13: å‹•ä½œç¢ºèª

- [ ] ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹
- [ ] ãƒ­ã‚°ã‚¤ãƒ³æ©Ÿèƒ½ç¢ºèª
- [ ] Queueå‹•ä½œç¢ºèªï¼ˆã‚¸ãƒ§ãƒ–æŠ•å…¥â†’å‡¦ç†ç¢ºèªï¼‰
- [ ] Scheduleå‹•ä½œç¢ºèªï¼ˆ`php artisan schedule:list`ã§ç¢ºèªï¼‰
- [ ] Google OAuthæ¥ç¶šç¢ºèª
- [ ] ãƒ¡ãƒ¼ãƒ«é€ä¿¡ç¢ºèª
- [ ] ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ç¢ºèª
- [ ] Node.jsã‚¹ã‚¯ãƒªãƒ—ãƒˆå‹•ä½œç¢ºèª

### ã‚¹ãƒ†ãƒƒãƒ—14: ç›£è¦–ãƒ»ãƒ­ã‚°è¨­å®š

- [ ] ãƒ­ã‚°ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®šï¼ˆ`logrotate`ï¼‰
- [ ] ã‚¨ãƒ©ãƒ¼ç›£è¦–è¨­å®šï¼ˆSentryç­‰ï¼‰
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–è¨­å®š
- [ ] ãƒ‡ã‚£ã‚¹ã‚¯ä½¿ç”¨é‡ç›£è¦–

---

## âš ï¸ é‡è¦ãªæ³¨æ„äº‹é …

### 1. APP_DEBUG
- **æœ¬ç•ªã§ã¯å¿…ãš`APP_DEBUG=false`ã«è¨­å®š**
- ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯`false`ã ãŒã€æ˜ç¤ºçš„ã«è¨­å®šã‚’æ¨å¥¨

### 2. Queue Worker
- **å¿…ãšSupervisorã§å¸¸é§åŒ–**
- å˜ç™ºå®Ÿè¡Œï¼ˆ`php artisan queue:work`ï¼‰ã¯æœ¬ç•ªã§ã¯éæ¨å¥¨

### 3. Schedule
- **Cronç™»éŒ²ãŒå¿…é ˆ**
- `php artisan schedule:run`ã‚’æ¯åˆ†å®Ÿè¡Œ

### 4. Node.jsã‚¹ã‚¯ãƒªãƒ—ãƒˆ
- **PM2ã§å¸¸é§åŒ–æ¨å¥¨**
- Chromeæ¥ç¶šãŒå¿…è¦ãªå ´åˆã¯ã€Chromeèµ·å‹•è¨­å®šã‚‚å¿…è¦

### 5. ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸
- **`storage:link`å®Ÿè¡Œå¿…é ˆ**
- `storage/app/public`ã¸ã®æ›¸ãè¾¼ã¿æ¨©é™ç¢ºèª

### 6. ã‚­ãƒ£ãƒƒã‚·ãƒ¥
- **æœ¬ç•ªã§ã¯å¿…ãšã‚­ãƒ£ãƒƒã‚·ãƒ¥æœ‰åŠ¹åŒ–**
- `config:cache`, `route:cache`, `view:cache`å®Ÿè¡Œ

### 7. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
- **æœ¬ç•ªã¯MySQLæ¨å¥¨**
- SQLiteã¯é–‹ç™ºç’°å¢ƒã®ã¿æ¨å¥¨

### 8. ãƒ­ã‚°
- **æœ¬ç•ªã§ã¯`LOG_LEVEL=error`æ¨å¥¨**
- ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š

---

## ğŸ” ç¢ºèªãŒå¿…è¦ãªé …ç›®

ä»¥ä¸‹ã®é …ç›®ã¯ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã‚’ã•ã‚‰ã«èª¿æŸ»ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼š

1. **åˆæœŸãƒ‡ãƒ¼ã‚¿ï¼ˆSeedï¼‰** âœ… ç¢ºèªæ¸ˆã¿
   - `DatabaseSeeder`ã¯ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿ä½œæˆ
   - ç®¡ç†è€…ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯æ‰‹å‹•ä½œæˆãŒå¿…è¦

2. **Node.jsã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ãƒãƒ¼ãƒˆ** âœ… ç¢ºèªæ¸ˆã¿
   - `rank-fetch-server.cjs`: ãƒãƒ¼ãƒˆ3000
   - ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯: `http://localhost:3000/health`

3. **Chromeæ¥ç¶šè¨­å®š** âœ… ç¢ºèªæ¸ˆã¿
   - æœ¬ç•ªç’°å¢ƒã§Chromeã‚’9222ãƒãƒ¼ãƒˆã§èµ·å‹•ã™ã‚‹å¿…è¦ã‚ã‚Š
   - èµ·å‹•ã‚³ãƒãƒ³ãƒ‰: `chrome --remote-debugging-port=9222`
   - Supervisorã¾ãŸã¯systemdã§å¸¸é§åŒ–æ¨å¥¨

4. **ãƒ¡ãƒ¼ãƒ«é€ä¿¡è¨­å®š** âš ï¸ ç¢ºèªå¿…è¦
   - ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: `MAIL_MAILER=log`ï¼ˆæœ¬ç•ªã§ã¯å¤‰æ›´å¿…é ˆï¼‰
   - ä½¿ç”¨ã™ã‚‹ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒ“ã‚¹ï¼ˆSMTP, Postmark, Resend, SESç­‰ï¼‰ã‚’æ±ºå®š
   - ãƒ¡ãƒ¼ãƒ«é€ä¿¡ã®ãƒ†ã‚¹ãƒˆæ–¹æ³•

5. **ãƒ­ã‚°å‡ºåŠ›å†…å®¹** âš ï¸ ç¢ºèªå¿…è¦
   - `Log::info()`, `Log::debug()`ã§æ©Ÿå¯†æƒ…å ±ãŒå‡ºåŠ›ã•ã‚Œã¦ã„ãªã„ã‹
   - æœ¬ç•ªç’°å¢ƒã§ã¯`LOG_LEVEL=error`æ¨å¥¨

---

## ğŸ“ ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã®ç¢ºèªã‚³ãƒãƒ³ãƒ‰

```bash
# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³çŠ¶æ…‹ç¢ºèª
php artisan about

# ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¿ã‚¹ã‚¯ä¸€è¦§
php artisan schedule:list

# QueueçŠ¶æ…‹ç¢ºèª
php artisan queue:monitor

# ã‚­ãƒ£ãƒƒã‚·ãƒ¥çŠ¶æ…‹ç¢ºèª
php artisan config:show
php artisan route:list

# ãƒ­ã‚°ç¢ºèª
tail -f storage/logs/laravel.log

# SupervisorçŠ¶æ…‹ç¢ºèª
supervisorctl status

# PM2çŠ¶æ…‹ç¢ºèª
pm2 status
pm2 logs
```

---

**ä½œæˆæ—¥**: 2026-02-11
**å¯¾è±¡ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³**: MEO (Laravel 12.0)
